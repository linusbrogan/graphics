this is Lucas Bulgarelli's fixes
